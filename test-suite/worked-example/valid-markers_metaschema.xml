<?xml version="1.0" encoding="UTF-8"?>
<?xml-model href="../../toolchains/xslt-proto-v04/lib/metaschema-check.sch" type="application/xml" schematypens="http://purl.oclc.org/dsdl/schematron"?>
<?xml-stylesheet type="text/css" href="../../toolchains/xslt-proto-v04/lib/metaschema-author.css"?>
<METASCHEMA xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://csrc.nist.gov/ns/oscal/metaschema/1.0 ../../toolchains/xslt-proto-v04/lib/metaschema.xsd"
    xmlns="http://csrc.nist.gov/ns/oscal/metaschema/1.0">
    <schema-name>OSCAL valid markers</schema-name>
    <schema-version>1.0</schema-version>
    <short-name>oscal-valid-markers</short-name>
    <namespace>http://csrc.nist.gov/metaschema/ns/resource-manifest-experimental</namespace>
    
    <define-assembly name="group">
        <formal-name>Nominal root</formal-name>
        <description>nominal root, for validation of this module. THIS DECLARATION MAY BE
        OVERRIDDEN IN A CALLING SCHEMA.</description>
        <model>
            <field ref="validate"/>
            <field ref="valid"/>
        </model>
    </define-assembly>
    
    <define-field name="validate" as-type="empty">
        <formal-name>Abstract validation</formal-name>
        <description>Points to an abstract rule set, by means of a reference to a work in the manifest.</description>
        <define-flag name="rules">
            <formal-name>Abstract rule set</formal-name>
        <description>Should resolve to a <code>work</code> elsewhere in the manifest, whereby technology-appropriate mappings may be made.</description>
        </define-flag>
    </define-field>
    
    <define-field name="valid" as-type="empty">
        <formal-name>(Actual) validations</formal-name>
        <description>In contrast to abstract validations, these are actual executable validation operations. As such, a validation may also imply or warrant further (processing) semantics. (tbd)</description>
        <define-flag name="timestamp" as-type="dateTime-with-timezone">
            <formal-name>Time Stamp</formal-name>
            <description>When a validation is represented as having been performed. Should not be a date in the future.</description>
        </define-flag>
        <flag ref="href"/>
    </define-field>
    
    <define-flag name="href" as-type="uri-reference">
            <formal-name>Hypertext reference</formal-name>
            <description>A relative URI, resolved with reference to base (ancestry).</description>        
    </define-flag>
    
</METASCHEMA>